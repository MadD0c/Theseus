#####################################################################
#
#   Server Settings Settings
#
#####################################################################

[server]
host: 0.0.0.0
port: 7125
klippy_uds_address: /home/theseus/printer_data/comms/klippy.sock

#####################################################################
#
#   Authentication Settings
#
#####################################################################

[authorization]
trusted_clients:
    10.0.0.0/8
    127.0.0.0/8
    169.254.0.0/16
    172.16.0.0/12
    192.168.0.0/16
    FE80::/10
    ::1/128
cors_domains:
    *.lan
    *.local
    *://localhost
    *://localhost:*
    *://my.mainsail.xyz
    *://app.fluidd.xyz
    *:7136  #<--Allow PrettyGCode (port 7136) on all domains (recommended) OR...
    *.local:7136  #<--Allow PrettyGCode (port 7136) on just .*local domain. (more secure I guess)

#####################################################################
#
#   Services Settings
#
#####################################################################

[mqtt]
address: 192.168.1.10
port: 1883
username: {secrets.mqtt_credentials.username}
password: {secrets.mqtt_credentials.password}
mqtt_protocol: v3.1.1
instance_name: theseus
status_objects:
       webhooks
       toolhead=position,print_time,homed_axes
       extruder=temperature,target
       heater_bed=temperature,target
       filament_switch_sensor=filament_detected
       print_stats
publish_split_status: True
default_qos: 0

[power printer]
type: mqtt
command_topic: zigbee2mqtt/3dprinter/set/state
command_payload:
    {command}
retain_command_state: False
query_topic: zigbee2mqtt/3dprinter/get/state
query_payload: ""
state_topic: zigbee2mqtt/3dprinter
state_response_template:
    {% set resp = payload|fromjson %}
    {resp["state"]}
query_after_command: False
restart_klipper_when_powered: True
bound_services:
    klipper

[timelapse]
output_path: ~/printer_data/timelapse/
frame_path: /tmp/timelapse/printer

[octoprint_compat]

[history]

[file_manager]
enable_object_processing: True

#####################################################################
#
#   Update Manager
#
#####################################################################

[update_manager]
channel: dev
refresh_interval: 168

[update_manager mainsail]
type: web
channel: stable
repo: mainsail-crew/mainsail
path: ~/mainsail

[update_manager klipper-macros]
type: git_repo
origin: https://github.com/jschuh/klipper-macros.git
path: ~/printer_data/config/macros/klipper-macros
primary_branch: main
is_system_service: False
managed_services: klipper

[update_manager crowsnest]
type: git_repo
path: ~/crowsnest
origin: https://github.com/mainsail-crew/crowsnest.git
install_script: tools/install.sh

[update_manager KlipperScreen]
type: git_repo
path: ~/KlipperScreen
origin: https://github.com/jordanruthe/KlipperScreen.git
env: ~/.KlipperScreen-env/bin/python
requirements: scripts/KlipperScreen-requirements.txt
install_script: scripts/KlipperScreen-install.sh
managed_services: KlipperScreen

[update_manager timelapse]
type: git_repo
primary_branch: main
path: ~/moonraker-timelapse
origin: https://github.com/mainsail-crew/moonraker-timelapse.git
managed_services: klipper moonraker
[include octoeverywhere-system.cfg]
